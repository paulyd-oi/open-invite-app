HANDOFF PACKET — P0 LOCKDOWN PATCH
===================================
Date: 2026-01-30
Commit: 7e236f6
Branch: main
Repo: github.com/paulyd-oi/open-invite-app.git

SUMMARY
-------
- KILLED all getEventColor wrapper functions (calendar.tsx, FeedCalendar.tsx)
- REPLACED with direct getEventPalette().bar usage at all render sites
- PURGED business event code from FeedCalendar.tsx (isBusinessEvent, businessName, businessLogo, etc.)
- REMOVED businessEvents prop from FeedCalendarProps and social.tsx usages
- DELETED Trophy export from icons.tsx (renamed to comment "Trophy REMOVED")
- ADDED title "busy" defensive filter in social.tsx (catches legacy data)
- CLEANED unused getEventBarColor import from calendar.tsx
- FIXED type in calendar.tsx EventListItem (removed isBusinessEvent from type)

ROOT CAUSES
-----------
1. FeedCalendar.tsx had its own getEventColor function that checked isBusinessEvent
2. FeedCalendar.tsx had full business event infrastructure (state, props, rendering)
3. calendar.tsx had a getEventColor wrapper that delegated to getEventBarColor
4. Trophy was still exported (just deprecated comment, not removed)
5. social.tsx passed businessEvents={undefined} to FeedCalendar

FILES CHANGED
-------------
1. src/app/calendar.tsx
   - Removed getEventColor function
   - Replaced getEventColor() calls with getEventPalette().bar
   - Removed getEventBarColor from import
   - Removed isBusinessEvent from EventListItem type

2. src/components/FeedCalendar.tsx
   - Removed Building2 icon import
   - Removed BusinessEvent type import
   - Removed getEventColor function entirely
   - Removed all business fields from CalendarEvent interface
   - Removed businessEvents from FeedCalendarProps
   - Removed showBusinessEvents state and toggleBusinessEvents function
   - Removed convertedBusinessEvents memo
   - Removed business UI (badge, host info branch)
   - Simplified eventCountsByDate to use getEventPalette
   - Removed commented business toggle section

3. src/ui/icons.tsx
   - Removed Trophy export (changed to comment "Trophy REMOVED")

4. src/app/social.tsx
   - Added shouldOmit helper with title "busy" check
   - Removed businessEvents prop from FeedCalendar usages

HARD GATE RESULTS
-----------------
=== GATE 1: BUSINESS (in scope files) ===
PASS: No isBusinessEvent

=== GATE 2: getEventColor ===
PASS: No getEventColor

=== GATE 3: TROPHY (actual usage) ===
PASS: No Trophy exports or imports

VERIFICATION OUTPUTS
--------------------
$ bun run typecheck
✓ No errors

$ bash scripts/ai/verify_frontend.sh
== REPO CONFIRMATION ==
/Users/paulsmbp/Documents/GitHub/open-invite-app
origin  https://github.com/paulyd-oi/open-invite-app.git (fetch)
main
== INVARIANT CHECK PASSED ==
== TYPECHECK ==
PASS: verify_frontend

MANUAL TEST CHECKLIST
---------------------
[ ] Create Busy event → grey bar (#6B7280) + grey bg (#6B728020) on month view
[ ] Tap day with busy → grey in day list
[ ] Work events → grey bar + grey bg (same as busy)
[ ] Social tab → no busy events appear (including title "busy" legacy)
[ ] Profile page → badge pills only, no trophy icons, no avatar overlays
[ ] Friend/user page → badge pills only, no trophy icons
[ ] Achievements → Award icon used (not Trophy)

COMMIT DETAILS
--------------
Hash: 7e236f6
Message: fix(P0): purge business + kill getEventColor + enforce busy/work grey + ban trophy
Push: 837b514..7e236f6 main -> main ✓

NOTES
-----
- Business profile type system (personal vs business) is PRESERVED - separate concern
- Building2 icon export preserved (for business-outline icon, not event-related)
- getEventBarColor still exported from eventPalette.ts (may have other consumers)
- All Trophy references in comments are INVARIANT documentation (acceptable)
