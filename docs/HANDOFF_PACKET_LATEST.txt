HANDOFF PACKET: Badge Pill Consistency Audit
=============================================
Date: 2026-02-02
Branch: main
Repo: github.com/paulyd-oi/open-invite-app.git

SUMMARY
-------
Audited and normalized badge pill rendering across all surfaces.
Replaced inline badge rendering with BadgePill component for consistency.
Verified badge data sources and selection flow.

BADGE DATA SOURCES (CONFIRMED)
------------------------------
- profile.tsx: profileData?.featuredBadge from /api/profile
- friends.tsx: friend.featuredBadge from friends list response
- friend/[id].tsx: friend.featuredBadge from /api/friends/:id/events (fallback query)
- user/[id].tsx: badgeData?.badge from /api/achievements/user/:id/badge
- event/[id].tsx: event.user?.featuredBadge from event response

BACKEND FIELD SHAPE (CONFIRMED)
-------------------------------
featuredBadge: { badgeKey, name, description, tierColor }
Frontend expects: { name, tierColor } via normalizeFeaturedBadge helper
ProfileBadge type: { name, tierColor, emoji?, ... }
All compatible - no field mismatch.

FILES CHANGED
-------------
- src/app/friend/[id].tsx - Added BadgePill import, replaced inline badge
- src/app/user/[id].tsx - Added BadgePill + normalizeFeaturedBadge imports,
                          replaced inline badge, added normalizedBadge var

BADGE SELECTION FLOW (CONFIRMED)
--------------------------------
achievements.tsx: api.put("/api/profile/featured-badge", { badgeKey })
- Sets/removes featured flag via backend
- Invalidates badgesCatalog + profile queries on success
- featured field identifies selected badge

SCREENS VERIFIED
----------------
1. Friend Profile Header (/friend/[id]) - BadgePill variant="small"
2. Friends Card (Detailed) - BadgePill variant="small"
3. Friends Card (List) - BadgePill variant="small"
4. User Profile (/user/[id]) - BadgePill variant="small"
5. Own Profile (/profile) - BadgePill variant="medium"
6. Event Detail (/event/[id]) - BadgePill component

BADGE DOCTRINE (CONFIRMED)
--------------------------
- OG badge = public + computed rank-based unlock (first 500)
- Gift badges = exclusive + manual grant
- Pro trio = public + auto-unlock when Pro
- Only user-selected featured badge displays (not first unlocked fallback)

VERIFICATION
------------
npm run typecheck - PASS
bash scripts/ai/verify_frontend.sh - PASS

NO NEW DEPENDENCIES
-------------------
Used existing: BadgePill, normalizeFeaturedBadge


