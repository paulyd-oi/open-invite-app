HANDOFF PACKET: Pre-TestFlight Final Pass
==========================================
Date: 2026-02-01
Branch: main
Repo: github.com/paulyd-oi/open-invite-app.git

SUMMARY
-------
Final polish pass before TestFlight build covering tasks A-H.
All typechecks pass; verify_frontend.sh PASS

TASK A: PUSH DIAGNOSTICS - ALREADY GATED
Location: src/app/settings.tsx lines 86-92
PUSH_DIAG_ALLOWLIST gates visibility to specific emails only.

TASK B: NOTIFICATION TOGGLES - ALL WIRED
File: src/app/notification-settings.tsx
Pattern: All 30+ toggles use updatePreference(key, value) to PUT /api/notifications/preferences

TASK C: ACTIVITY FEED CATEGORY TINTS - IMPLEMENTED
File: src/app/activity.tsx
NotificationCard now uses config.color + "08" for category-specific background tints.

TASK D: PRIVACY SETTINGS - ALL WIRED
File: src/app/privacy-settings.tsx
Toggles -> PUT /api/privacy, Export -> GET /api/privacy/export, Delete -> DELETE /api/privacy/account

TASK E: BLOCK CONTRACTS - VERIFIED
File: src/app/blocked-contacts.tsx
GET /api/blocked, POST /api/blocked, DELETE /api/blocked/:id all wired.

TASK F: FRIEND CARD BADGE - ALREADY EXISTS
src/app/friends.tsx uses BadgePill, src/app/friend/[id].tsx shows inline badge.

TASK G: SUGGESTIONS ALGORITHM - DOCUMENTED
GET /api/friends/suggestions, useSuggestionsFeed() hook provides personalized feed.

TASK H: SUGGESTIONS ADD-FRIEND ENTRY - IMPLEMENTED
Search icon added to suggestions header, navigates to /friends?search=true.

FILES CHANGED
-------------
1. src/app/activity.tsx - Category-based tints
2. src/app/suggestions.tsx - Search icon in header
3. src/app/friends.tsx - Auto-open search from URL param
  - Delete Modal

  REMOVED HANDLERS:
  - handleSaveProOverride()
  - handleBanUser()
  - handleUnbanUser()
  - handleDeleteUser()
  - handleBadgeToggle() (dead code using deprecated badge ID functions)

REMAINING BADGE STUDIO FEATURES
-------------------------------
1. BADGE DEFINITIONS panel - List all badges with New Badge button
2. Create/Edit Badge Modal - badgeKey, name, description, emoji, tierColor, isExclusive, isActive
3. USER LOOKUP - Search users by name/username/email
4. USER DETAIL - Show selected user info
5. GRANTED BADGES - Show user's current badges with Revoke buttons
6. GRANT A BADGE - Horizontal badge picker + note field + Grant button

BACKEND ENDPOINTS USED (existing - no changes required)
-------------------------------------------------------
- GET /api/admin/badges - List badge definitions
- POST /api/admin/badges - Create badge
- PATCH /api/admin/badges/:badgeKey - Update badge
- GET /api/admin/users/:userId/badges - Get user badges
- POST /api/admin/users/:userId/badges/grant - Grant badge by key
- POST /api/admin/users/:userId/badges/revoke - Revoke badge by key

VERIFICATION
------------
npm run typecheck: PASS
bash scripts/ai/verify_frontend.sh: PASS
Commit: 4ad8e83 pushed to origin/main

ASSUMPTIONS
-----------
- Badge doctrine: OG badges = earnable via rank, Gift badges = isExclusive + manual only
- Pro trio badges (pro, pro_silver, pro_gold) = public + auto-granted via RevenueCat
- Old handleBadgeToggle function was dead code - UI uses handleGrantBadge and handleRevokeBadgeByKey
