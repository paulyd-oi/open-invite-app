CLAUDE OPUS — OPEN INVITE STABILIZATION TEMPLATE (GOLDEN FLOWS + TESTFLIGHT BATCHING)

MODEL REQUIREMENT:
Use Claude Opus.

READ FIRST (MANDATORY):
docs/GOLDEN_FLOWS.md
docs/UX_CONTRACTS.md
docs/RC_BATCH_NEXT.md
docs/INVARIANTS.md (if present)
docs/STATE_OF_THE_APP.md (if present)
docs/FINDINGS_LOG.md (if present)

ABSOLUTE RULES (NON-NEGOTIABLE):
ONE ISSUE PER TASK. Fix ONLY the issue described under “TASK (GOLDEN FLOW)”.

Outcome-first: success is defined by ACCEPTANCE CHECKS passing in the actual UI on the required surface (SIMULATOR vs TESTFLIGHT DEVICE), not by code inspection.

Never claim success by “looks right” or “API returns X” alone.

Must do a blast-radius sweep: search for other occurrences of the same pattern and either fix them or explicitly justify why not.

Minimal diff. No new dependencies. Preserve navigation architecture. No refactors.

No breaking UI changes outside the task scope.

UI / Pressable / NativeWind:
Never use Pressable style function callback (style={({pressed})=>...}) in SSOT components;
NativeWind wrapper may not run it. Use pressed state (useState + onPressIn/onPressOut) + static style arrays.

If backend routes/mounts are touched, prove parity in BOTH src/index.ts and src/server.ts.

REPO + RELEASE GUARDRAILS (MANDATORY):
Confirm repo is correct (open-invite-app).
Confirm branch name.
Confirm working tree clean before starting (or explicitly list existing changes).
Do not create or commit *_HANDOFF*.txt|md files. (Only docs/HANDOFF_PACKET_LATEST.txt if repo doctrine requires it; otherwise HANDOFF is chat output only.)
Only update SSOT docs if REQUIRED by the task (GOLDEN_FLOWS / UX_CONTRACTS / FINDINGS / RC_BATCH_NEXT), and keep changes minimal.
If this task changes frontend behavior, PUSH FRONTEND (commit + push) before claiming ready for TestFlight batching.

TEXTSAFE DISCIPLINE:
Your final output MUST be plain text (no markdown tables, no fancy formatting).
If you provide commands, they must be copy-paste safe with no inline comments.
Do not output multiple “optional paths”. Provide ONE path that matches the task.

TESTFLIGHT BATCHING RULES (CRITICAL):
Some acceptance checks are device/TestFlight-only. Do NOT pretend we can “immediately test on device” if a new binary is required.

If ACCEPTANCE CHECKS specify TESTFLIGHT DEVICE:
1) You MUST mark the task as “BATCHED” and append it to docs/RC_BATCH_NEXT.md (or update its existing entry).
2) You MUST still implement the minimal fix now and provide strongest possible non-device proof:
   - exact code path + root cause
   - blast-radius sweep results
   - local reproduction steps if possible
   - simulator steps if applicable
   - logs that prove the flow is executing (DEV tags)
3) You MUST NOT claim “COMPLETE”. Use status:
   STATUS: READY FOR TESTFLIGHT VALIDATION (BATCHED)
4) In VERIFICATION, include the exact TestFlight device steps to run AFTER the next build ships.
5) In HANDOFF, include a line: BATCH ENTRY UPDATED: yes/no + what changed.

If ACCEPTANCE CHECKS specify SIMULATOR OK:
You MAY mark complete if simulator steps pass AND you provide proof logs tied to the Golden Flow.

TASK INPUT FORMAT (PASTED BY USER):

TASK (GOLDEN FLOW)

GOLDEN FLOW (1–2 sentences, user intent)

CURRENT BEHAVIOR (what actually happens; include screenshots/logs references)

ACCEPTANCE CHECKS
- Each check must be observable in UI
- Must explicitly declare surface: SIMULATOR or TESTFLIGHT DEVICE
- Must include “done when…” criteria (counts, labels, visibility, navigation outcome)

NON-GOALS (what not to change)

ASSETS
- screenshots
- logs
- reproduction steps
- any relevant contract excerpt (from UX_CONTRACTS)

WORK PLAN (YOU MUST FOLLOW):
A) Restate the Golden Flow in 1–2 lines (intent, not implementation).
B) Identify root cause with exact file + line range(s).
C) Implement minimal fix.
D) Blast-radius sweep:
   - List exact search queries you ran (rg terms) and what you found.
   - Fix any other matches that violate the same contract OR explicitly justify exclusion.
E) Verification:
   - If SIMULATOR: give exact steps + what to observe.
   - If TESTFLIGHT DEVICE: update RC_BATCH_NEXT.md and give exact steps to run post-build.
F) REQUIRED DEV PROOF:
   - Add or use existing DEV log tags ONLY when they prove acceptance checks.
   - Logs must correspond to the actual flow (not generic “loaded ok”).
   - Prefer a single canonical tag for the task (e.g., [P0_WHO_COMING]) and avoid multiple tags.

HANDOFF PACKET (MANDATORY, PLAIN TEXT, ONLY THIS TASK):
Include exactly:

STATUS (COMPLETE or READY FOR TESTFLIGHT VALIDATION (BATCHED))

SUMMARY

GOLDEN FLOW (1–2 lines)

ROOT CAUSE (file + line range)

FIX (file + line range)

BLAST RADIUS SWEEP (search terms + results)

VERIFICATION STEPS (must match Acceptance Checks; include SIMULATOR vs TESTFLIGHT DEVICE)

BATCH ENTRY UPDATED (yes/no; if yes, what line/item added/edited in docs/RC_BATCH_NEXT.md)

GIT PROOF (paste exact outputs; MUST match actual commit):
git show --stat HEAD
git show --name-only HEAD

TASK:
[PASTE ONE ISSUE’S GOLDEN FLOW BLOCK HERE]

END OF TEMPLATE
