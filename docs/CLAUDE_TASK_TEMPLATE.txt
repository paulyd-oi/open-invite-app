CLAUDE OPUS — OPEN INVITE STABILIZATION TEMPLATE (GOLDEN FLOWS + TESTFLIGHT BATCHING + USERROW SSOT)

MODEL REQUIREMENT:
Use Claude Opus.

READ FIRST (MANDATORY):
docs/GOLDEN_FLOWS.md
docs/UX_CONTRACTS.md
docs/RC_BATCH_NEXT.md
docs/INVARIANTS.md (if present)
docs/STATE_OF_THE_APP.md (if present)
docs/FINDINGS_LOG.md (if present)

ABSOLUTE RULES (NON-NEGOTIABLE):

ONE ISSUE PER TASK. Fix ONLY the issue described under “TASK (GOLDEN FLOW)”.

Outcome-first: success is defined by ACCEPTANCE CHECKS passing in the actual UI on the required surface (SIMULATOR vs TESTFLIGHT DEVICE), not by code inspection.

Never claim success by “looks right” or “API returns X” alone.

Must do a blast-radius sweep: search for other occurrences of the same pattern and either fix them or explicitly justify why not.

Minimal diff. No new dependencies. Preserve navigation architecture. No refactors.

No breaking UI changes outside the task scope.

USER ROW + BOTTOM SHEET SSOT DOCTRINE (MANDATORY)

UserRow is the SSOT list-row primitive for people surfaces.

All people rows (friends lists, rosters, pickers, sheets) MUST use UserRow unless the task explicitly justifies a deviation.

Row layout invariants:

Horizontal layout only: avatar | text column | optional accessory

flexDirection: "row" and alignItems: "center" must be enforced inside UserRow, not caller styles

Callers must NOT override row layout props

Text contract:

Roster/navigation lists: primary = display name

Picker lists: primary = @handle, secondary = bio (if present)

Chevron rules:

Push-navigation lists MAY show chevrons

Bottom sheets MUST NOT show chevrons

Sheets are modal contexts, not navigation surfaces

Right accessory rules:

Accessories (trash, checkbox, etc.) must be explicit and not wrapped in layout-breaking containers

Accessory taps must not trigger row onPress

PRESSABLE + NATIVEWIND DOCTRINE (MANDATORY)

Never use Pressable style callback:
style={({pressed}) => ...}

NativeWind wrappers may not execute this callback, causing layout styles (flexDirection/alignItems) to fail.

Instead ALWAYS use:

useState pressed flag

onPressIn / onPressOut

static style arrays with conditional pressed styling

This rule is REQUIRED for all SSOT interactive components.

If backend routes/mounts are touched, prove parity in BOTH src/index.ts and src/server.ts.

REPO + RELEASE GUARDRAILS (MANDATORY):

Confirm repo is correct (open-invite-app).
Confirm branch name.
Confirm working tree clean before starting (or explicitly list existing changes).

Do not create or commit _HANDOFF.txt|md files.
(Only docs/HANDOFF_PACKET_LATEST.txt if repo doctrine requires it; otherwise HANDOFF is chat output only.)

Only update SSOT docs if REQUIRED by the task (GOLDEN_FLOWS / UX_CONTRACTS / FINDINGS / RC_BATCH_NEXT), and keep changes minimal.

If this task changes frontend behavior, PUSH FRONTEND (commit + push) before claiming ready for TestFlight batching.

TEXTSAFE DISCIPLINE:

Final output MUST be plain text.
No markdown tables.
No fancy formatting.

Commands must be copy-paste safe with no inline comments.

Provide ONE implementation path — no branching options.

TESTFLIGHT BATCHING RULES (CRITICAL)

Some acceptance checks are device/TestFlight-only. Do NOT pretend we can immediately validate device behavior without a new binary.

If ACCEPTANCE CHECKS specify TESTFLIGHT DEVICE:

Mark task as BATCHED and append/update docs/RC_BATCH_NEXT.md

Implement minimal fix now

Provide strongest non-device proof:

exact code path + root cause

blast-radius sweep

simulator/local steps if possible

DEV proof logs

Do NOT mark COMPLETE

Status must be:
STATUS: READY FOR TESTFLIGHT VALIDATION (BATCHED)

VERIFICATION must include exact TestFlight steps to run after shipping.

HANDOFF must include:
BATCH ENTRY UPDATED: yes/no + what changed

If ACCEPTANCE CHECKS specify SIMULATOR OK:
Task may be marked COMPLETE with matching UI proof + DEV logs.

TASK INPUT FORMAT (PASTED BY USER)

TASK (GOLDEN FLOW)

GOLDEN FLOW
(1–2 sentences describing user intent)

CURRENT BEHAVIOR
(actual behavior; reference screenshots/logs)

ACCEPTANCE CHECKS

Each check observable in UI

Explicit surface: SIMULATOR or TESTFLIGHT DEVICE

Must include “done when…” criteria

NON-GOALS

ASSETS

screenshots

logs

reproduction steps

relevant UX contract excerpt

WORK PLAN (YOU MUST FOLLOW)

A) Restate Golden Flow intent
B) Identify root cause (file + line range)
C) Minimal fix
D) Blast-radius sweep

list search queries

results + fixes or justification
E) Verification

simulator OR TestFlight steps
F) REQUIRED DEV PROOF

canonical DEV tag tied to flow

logs must prove acceptance checks

HANDOFF PACKET (MANDATORY — ONLY THIS TASK)

STATUS

SUMMARY

GOLDEN FLOW

ROOT CAUSE (file + line range)

FIX (file + line range)

BLAST RADIUS SWEEP

VERIFICATION STEPS

BATCH ENTRY UPDATED

GIT PROOF:
git show --stat HEAD
git show --name-only HEAD

TASK:
[PASTE ONE ISSUE’S GOLDEN FLOW BLOCK HERE]

END OF TEMPLATE